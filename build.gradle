plugins {
    id 'java-library'
    id 'org.ajoberstar.grgit' version '4.0.0-rc.1' apply false
}

allprojects {
    repositories {
        jcenter()
    }
}

test {
  testLogging.showStandardStreams = true
}

repositories
{
    // Use jcenter for resolving dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}

dependencies {
    // Use JUnit test framework
    testImplementation 'junit:junit:4.12'
}

task prepare {
    dependsOn ':subproj-php-native:prepGitDeps'
    dependsOn ':subproj-php-native:buildNativePhpHeader'
}

// We need to build native library after preparations are done
prepare.finalizedBy ':subproj-php-native:buildObjFile'

// Build can run only after preparations
build.dependsOn "prepare"

// Do not test while building (or tests can be started while building BEFORE library is built - will be an error)
build.dependsOn.remove("check")